#### 树洞

- 完全匿名：只需要在登录时用学生邮箱验证身份，但你的发言绝对不会和学号挂钩！
- 信息保护：单向对用户id进行加密，后台也查不出是谁发的，非常安全。
  - （存在用特殊暴力手段查出的可能性，谨记互联网上没有绝对的隐私）
- 弱社交：发出去的帖子不带有任何个人信息，可回复，回复同样不带有任何个人信息。
- 私信：想与某人联系，可以点它，但必须等对方接受才能建立一个临时聊天框，聊天结束后销毁，支持生成图片保存。
  - 是否公开自己的信息，由用户自己定夺。
- 帖子Tag以及帖子筛选
-  新闻热点：校内外热点新闻话题，可以由管理员导入/系统自动获取，形成一帖并标有新闻TAG。
- 个人功能：
  - 发帖
  - 写随笔，随时可发
  - 大喊：乱写一些东西丢进树洞，什么也不会发生，保证绝对安全（
  - 连线：写一个想聊的话题，随机匹配一个类似的人开一个临时聊天框。



#### 匿名&权限处理方法

不使用wx登录（云数据库会乱塞openID，很麻烦）

加密算法存在服务端，是某种魔改MD5

使用邮箱登录，将邮箱单向加密**两次**，第一次的结果作为secret_id，第二次的结果作为user_id，公开且用user_id索引。

secret_id不存入数据库，直接单独发送给用户作为认证标识。

所有操作在后端进行，用户需将自己的secret_id带上以作为验证。



即便知道了加密算法，也不能从user_id推算出secret_id，权限上安全，也不能推算出邮箱。

但如果加密算法和邮箱都被别人知道，就能找出是谁了	



#### 数据库

- 用户 user
  - user_id(_id)
  - avatar
  - name
  - confirm_time
- 帖子记录 post
  - post_id(_id)
  - user_id
  - post_time
  - title
  - content
  - imgs [fileID]
  - tags []
- 评论记录 comment
  - comment_id(_id)
  - user_id
  - content
  - level (一级评论，二级评论，三级评论)
  - post_id (楼主)
  - father_id (对于2,3级评论，记录属于哪个1级评论，层主)
  - reply_id (对于2,3级评论，记录回复目标的secret_id（只有三级评论用到)
  - comment_time
- 点赞（关系表）upvote
  - user_id
  - target_id （comment或post的id）
  - type （comment或post）

- 收藏（关系表）star
  - user_id
  - post_id




todos:

本地更新

访客判断
